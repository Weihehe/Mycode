#include <jni.h>
#include <opencv2/core/core.hpp>
#include <opencv2/imgproc/imgproc.hpp>
#include <opencv2/features2d/features2d.hpp>

using namespace cv;
extern "C" {


// Just show the plain camera image without modifying it.
JNIEXPORT void JNICALL Java_com_Cartoonifier_CartoonifierView_ShowPreview(JNIEnv* env, jobject,
        jint width, jint height, jbyteArray yuv, jintArray bgra)
{
	//访问给定的java数组
	jbyte* _yuv = env->GetByteArrayElements(yuv,0);
	jint *_bgra = env->GetIntArrayElements(bgra,0);
	//定义了2个cv：：Mat对象，让其指向给定像素缓冲区的数据
	Mat myuv = Mat(height+ height/2,width,CV_8UC1,(uchar *)_yuv);
	Mat mbgra = Mat(height,width,CV_8UC4,(uchar *)_bgra);

	cvtColor(myuv,mbgra,CV_YUV420sp2BGRA);

	env->ReleaseIntArrayElements(bgra,_bgra,0);
	env->ReleaseByteArrayElements(yuv,_yuv,0);
}


}
